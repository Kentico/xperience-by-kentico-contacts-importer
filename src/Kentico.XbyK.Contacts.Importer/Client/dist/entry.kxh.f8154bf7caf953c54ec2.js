System.register(["react","@kentico/xperience-admin-components"],(function(e,t){var r={},l={};return{setters:[function(e){r.default=e.default,r.useState=e.useState},function(e){l.Button=e.Button,l.ButtonSize=e.ButtonSize}],execute:function(){e((()=>{var e={722:(e,t,r)=>{const l=r(905).R;t.s=function(e){if(e||(e=1),!r.y.meta||!r.y.meta.url)throw console.error("__system_context__",r.y),Error("systemjs-webpack-interop was provided an unknown SystemJS context. Expected context.meta.url, but none was provided");r.p=l(r.y.meta.url,e)}},905:(e,t,r)=>{t.R=function(e,t){var r=document.createElement("a");r.href=e;for(var l="/"===r.pathname[0]?r.pathname:"/"+r.pathname,n=0,a=l.length;n!==t&&a>=0;)"/"===l[--a]&&n++;if(n!==t)throw Error("systemjs-webpack-interop: rootDirectoryLevel ("+t+") is greater than the number of directories ("+n+") in the URL path "+e);var o=l.slice(0,a+1);return r.protocol+"//"+r.host+o};Number.isInteger},271:e=>{"use strict";e.exports=l},954:e=>{"use strict";e.exports=r}},n={};function a(t){var r=n[t];if(void 0!==r)return r.exports;var l=n[t]={exports:{}};return e[t](l,l.exports,a),l.exports}a.y=t,a.d=(e,t)=>{for(var r in t)a.o(t,r)&&!a.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.p="";var o={};return(0,a(722).s)(1),(()=>{"use strict";a.r(o),a.d(o,{CustomLayoutTemplate:()=>n});var e=a(954),t=a(271);let r=!0,l=!1;const n=n=>{let{label:a,contactGroups:o}=n;const[s,u]=(0,e.useState)(a),[c,i]=(0,e.useState)(null),[d,p]=(0,e.useState)([]),[m,f]=(0,e.useState)({current:0,total:0}),[g,v]=(0,e.useState)("insert"),[y,h]=(0,e.useState)("<null>"),[S,b]=(0,e.useState)(","),[E,x]=(0,e.useState)(5e3);return e.default.createElement("div",null,e.default.createElement("h1",null,s),e.default.createElement("input",{type:"file",onChange:e=>null!=e.target.files?i(e.target.files[0]||null):null}),e.default.createElement("div",{onChange:e=>{console.log("target",e.target,e.currentTarget);const t=e.target?.value;t&&v(t)}},e.default.createElement("h3",null,"Select mode"),e.default.createElement("div",null,e.default.createElement("label",{htmlFor:"pk_delete"},"Delete"),e.default.createElement("input",{id:"pk_delete",name:"ProcessingKind",type:"radio",value:"delete",checked:"delete"===g})),e.default.createElement("div",{style:{paddingTop:"10px"}},e.default.createElement("label",{htmlFor:"pk_insert"},"Insert (skip existing)"),e.default.createElement("input",{id:"pk_insert",name:"ProcessingKind",type:"radio",value:"insert",checked:"insert"===g}))),e.default.createElement("div",{style:{paddingTop:"10px"}},e.default.createElement("label",{htmlFor:"cgSelector"},"Assign to contact group",e.default.createElement("select",{value:y,onChange:e=>h(e.target.value)},e.default.createElement("option",{value:"<null>"},"No contact group"),o.map((t=>e.default.createElement("option",{value:t.guid},t.displayName)))))),e.default.createElement("label",null,"Delimiter",e.default.createElement("input",{value:S,onChange:e=>{b(e.target.value)}})),e.default.createElement("label",null,"Batch size",e.default.createElement("input",{value:E,onChange:e=>{x(Number(e.target.value))},type:"number"})),e.default.createElement("pre",{style:{border:"2px dotted magenta"}},`Upload progress:${Math.floor(m.current/m.total*100)}%\n`,e.default.createElement("progress",{id:"progress_",value:m.current,max:m.total,style:{width:"100%"}})),e.default.createElement(t.Button,{label:"Send file",size:t.ButtonSize.S,onClick:()=>{if(null!=c){console.log(c);let e=""!=location.port?`:${location.port}`:"";const t=new WebSocket("wss://"+location.hostname+`${e}/contactsimport/ws`);t.binaryType="blob",t.onerror=e=>{console.log("error occured",e),r=!1,t.close()},t.onmessage=e=>{var n=JSON.parse(e.data);switch(n.type){case"headerConfirmed":console.log("header confirmed, starting import"),function(e,n,a){var o=e.size,s=32768,u=0,c=null,i=function(l){if(r)if(null!=l.target){if(null!=l.target.error||null==l.target.result)return a(),void console.log("Read error: "+l.target.error);if(u+=s,n=l.target.result,t.readyState==t.OPEN&&(t.send(n),1))return u>=o?(a(),void console.log("Done reading file")):void(null!=c&&r&&c(u,s,e))}else console.log("progress is null");var n};(c=function(e,t,r){var n=new FileReader,a=r.slice(e,t+e);n.onload=i,l?(setTimeout((()=>{n.readAsText(a)}),3e3),console.log("too fast => wait 3s"),l=!1):n.readAsText(a)})(u,s,e)}(c,0,(()=>{setTimeout((()=>{t.close()}),2e3)}));break;case"toofast":l=!0;break;case"msg":p((e=>[...e,n.payload]));break;case"progress":{const e=parseInt(n.payload);f((t=>({total:t.total,current:t.current+e})));break}case"finished":console.log("closing socket"),r=!1,t.readyState<t.CLOSING&&t.close()}},t.onopen=function(e){r=!0,p((e=>[...e,`Sending file of length: ${c.size}`])),console.log("connected"),f({total:c.size,current:0}),t.send(JSON.stringify({type:"header",payload:{importKind:g,contactGroup:"<null>"===y?null:y,delimiter:S,batchSize:E}}))}}else alert("no file selected")}}),e.default.createElement("pre",{style:{overflow:"scroll"}},[...d].reverse().join("\r\n")))}})(),o})())}}}));