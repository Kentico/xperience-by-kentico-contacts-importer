System.register(["react","@kentico/xperience-admin-components"],(function(e,t){var r={},o={};return{setters:[function(e){r.default=e.default,r.useState=e.useState},function(e){o.Button=e.Button,o.ButtonSize=e.ButtonSize}],execute:function(){e((()=>{var e={722:(e,t,r)=>{const o=r(905).R;t.s=function(e){if(e||(e=1),!r.y.meta||!r.y.meta.url)throw console.error("__system_context__",r.y),Error("systemjs-webpack-interop was provided an unknown SystemJS context. Expected context.meta.url, but none was provided");r.p=o(r.y.meta.url,e)}},905:(e,t,r)=>{t.R=function(e,t){var r=document.createElement("a");r.href=e;for(var o="/"===r.pathname[0]?r.pathname:"/"+r.pathname,n=0,l=o.length;n!==t&&l>=0;)"/"===o[--l]&&n++;if(n!==t)throw Error("systemjs-webpack-interop: rootDirectoryLevel ("+t+") is greater than the number of directories ("+n+") in the URL path "+e);var a=o.slice(0,l+1);return r.protocol+"//"+r.host+a};Number.isInteger},271:e=>{"use strict";e.exports=o},954:e=>{"use strict";e.exports=r}},n={};function l(t){var r=n[t];if(void 0!==r)return r.exports;var o=n[t]={exports:{}};return e[t](o,o.exports,l),o.exports}l.y=t,l.d=(e,t)=>{for(var r in t)l.o(t,r)&&!l.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},l.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),l.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.p="";var a={};return(0,l(722).s)(1),(()=>{"use strict";l.r(a),l.d(a,{CustomLayoutTemplate:()=>n});var e=l(954),t=l(271);let r=!0,o=!1;const n=n=>{let{label:l,contactGroups:a}=n;const[s,c]=(0,e.useState)(l),[i,u]=(0,e.useState)(null),[d,p]=(0,e.useState)([]),[f,m]=(0,e.useState)({current:0,total:0}),[g,y]=(0,e.useState)("insert"),[v,h]=(0,e.useState)("<null>");return e.default.createElement("div",null,e.default.createElement("h1",null,s),e.default.createElement("input",{type:"file",onChange:e=>null!=e.target.files?u(e.target.files[0]||null):null}),e.default.createElement("div",{onChange:e=>{console.log("target",e.target,e.currentTarget);const t=e.target?.value;t&&y(t)}},e.default.createElement("h3",null,"Select mode"),e.default.createElement("div",null,e.default.createElement("label",{htmlFor:"pk_delete"},"Delete"),e.default.createElement("input",{id:"pk_delete",name:"ProcessingKind",type:"radio",value:"delete",checked:"delete"===g})),e.default.createElement("div",{style:{paddingTop:"10px"}},e.default.createElement("label",{htmlFor:"pk_insert"},"Insert (skip existing)"),e.default.createElement("input",{id:"pk_insert",name:"ProcessingKind",type:"radio",value:"insert",checked:"insert"===g}))),e.default.createElement("div",{style:{paddingTop:"10px"}},e.default.createElement("label",{htmlFor:"cgSelector"},"Assign to contact group",e.default.createElement("select",{value:v,onChange:e=>h(e.target.value)},e.default.createElement("option",{value:"<null>"},"No contact group"),a.map((t=>e.default.createElement("option",{value:t.guid},t.displayName)))))),e.default.createElement("pre",{style:{border:"2px dotted magenta"}},`Uplaod progress:${Math.floor(f.current/f.total*100)}%\n`,e.default.createElement("progress",{id:"progress_",value:f.current,max:f.total,style:{width:"100%"}})),e.default.createElement(t.Button,{label:"Send file",size:t.ButtonSize.S,onClick:()=>{if(null!=i){console.log(i);let e=""!=location.port?`:${location.port}`:"";const t=new WebSocket("wss://"+location.hostname+`${e}/contactsimport/ws`);t.binaryType="blob",t.onerror=e=>{console.log("error occured",e),r=!1},t.onmessage=e=>{var n=JSON.parse(e.data);switch(n.type){case"headerConfirmed":console.log("header confirmed, starting import"),function(e,n,l){var a=e.size,s=32768,c=0,i=null,u=function(o){if(r)if(null!=o.target){if(null!=o.target.error||null==o.target.result)return l(),void console.log("Read error: "+o.target.error);if(c+=s,n=o.target.result,t.readyState==t.OPEN&&(t.send(n),1))return c>=a?(l(),void console.log("Done reading file")):void(null!=i&&r&&i(c,s,e))}else console.log("progress is null");var n};(i=function(e,t,r){var n=new FileReader,l=r.slice(e,t+e);n.onload=u,o?(setTimeout((()=>{n.readAsText(l)}),3e3),console.log("too fast => wait 3s"),o=!1):n.readAsText(l)})(c,s,e)}(i,0,(()=>{setTimeout((()=>{t.close()}),2e3)}));break;case"toofast":o=!0;break;case"msg":p((e=>[...e,n.payload]));break;case"progress":{const e=parseInt(n.payload);m((t=>({total:t.total,current:t.current+e})));break}case"finished":console.log("closing socket"),r=!1,t.readyState<t.CLOSING&&t.close()}},t.onopen=function(e){r=!0,p((e=>[...e,`Sending file of length: ${i.size}`])),console.log("connected"),m({total:i.size,current:0}),t.send(JSON.stringify({type:"header",payload:{importKind:g,contactGroup:"<null>"===v?null:v}}))}}else alert("no file selected")}}),e.default.createElement("pre",{style:{overflow:"scroll"}},[...d].reverse().join("\r\n")))}})(),a})())}}}));